# Prosjekt i Robot host 2015

from Tkinter import Tk, Button, W, Entry, Label, Canvas
import threading, imghdr
import cv2
import time

class HovedMeny():

    # init fungerer som en "contstructor".
    def __init__(self,hovedVindu):
        self.master = hovedVindu

    def Knapper(self):
        # Genererer alle knappene til hovedvinduet.
        self.NAOipLabel = Label(self.master, text="NAO IP adresse")
        self.NAOipLabel.config(height = 4, width=20)
        self.NAOipLabel.grid(row=1, column=1, padx=2, pady=10, sticky=W)

        self.NAOipTekst = Entry(self.master)
        self.NAOipTekst.config(width=15)
        self.NAOipTekst.grid(row=1, column=2, padx=2, pady=10, sticky=W)

        self.NAOPortLabel = Label(self.master, text="NAO Port nummer")
        self.NAOPortLabel.config(height = 4, width=20)
        self.NAOPortLabel.grid(row=1, column=3, padx=2, pady=10, sticky=W)

        self.NAOPortTekst = Entry(self.master)
        self.NAOPortTekst.config(width=8)
        self.NAOPortTekst.grid(row=1, column=4, padx=2, pady=10, sticky=W)

        self.NAOipTilkobling = Button(self.master, text="Koble til NAO robot", bg = "grey", command = self.IPInput)
        self.NAOipTilkobling.config(width=20)
        self.NAOipTilkobling.grid(row=1, column=5, padx=20, pady=10, sticky=W)

        self.StartStoppVideo = Button(self.master, text="Start Video", bg = "grey", command = self.startStoppToggle)
        self.StartStoppVideo.config(height = 4, width=20)
        self.StartStoppVideo.grid(row=2, column=1, padx=2, pady=10, sticky=W)

        self.test2_button = Button(self.master, text="Menyvalg 2", bg = "grey")
        self.test2_button.config(height = 4, width=20)
        self.test2_button.grid(row=3, column=1, padx=2, pady=10, sticky=W)

        self.test3_button = Button(self.master, text="Avslutt", bg = "grey", command = self.master.quit)
        self.test3_button.config(height = 4, width=20)
        self.test3_button.grid(row=4, column=1, padx=2, pady=10, sticky=W)


    def VideoLayout(self):
        # Lager tomme vinduer for video
        self.originalVideo = Canvas(self.master, width=640, height = 480, bg="white")
        self.originalVideo.grid(row=2, column=2,padx=2, pady=25, rowspan = 5, columnspan = 5, sticky=W)

        self.segmentertVideo = Canvas(self.master, width=640, height = 480, bg="white")
        self.segmentertVideo.grid(row=2, column=8, padx=2, pady=25, rowspan = 5, columnspan = 5, sticky=W)


    def startStoppToggle(self):
        # Toggleknapp for start og stopp av video. Starter threading for innlasting av video
        if self.StartStoppVideo.config('text')[-1] == "Start Video":
            self.StartStoppVideo.config(text="Stopp Video")
            self.lastInnVideo = False
            self.t = threading.Thread(target=self.VideoInnhenting)
            self.t.start()
        else:
            self.StartStoppVideo.config(text="Start Video")
            self.lastInnVideo = True


    def IPInput(self):
        # Hentet IP og Port nummer fra tekslastInnVideo = Falsetfeltet. Printes ut i terminalvinduet.
        NAOip = self.NAOipTekst.get()
        NAOport = self.NAOPortTekst.get()
        print(NAOip)
        print(NAOport)


    def VideoInnhenting(self):
        # Traad for innlasting av bilde
        self.opptak = cv2.VideoCapture(0)

        while(self.lastInnVideo == False):
            ret, frame = self.opptak.read()
            
            if ret == True:
                bilde = cv2.imread(frame,)

                self.originalVideo.create_image(0,0, image=graaBilde)

                time.sleep(1)

            time.sleep(1)

        self.opptak.release()
        cv2.destroyAllWindows()


# Oppretter hovedvinduet
root = Tk()
root.geometry("1500x700")
root.title("Prosjekt i Robot")

# Oppretter en instans av HovedMeny
program = HovedMeny(root)
program.Knapper()
program.VideoLayout()

# Starter event handling
root.mainloop()





